<Page
    x:Class="ChaosSeed.WinUI3.Pages.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls">

    <ScrollViewer>
        <Grid Padding="{StaticResource ChaosPagePadding}">
            <Grid.Transitions>
                <TransitionCollection>
                    <EntranceThemeTransition FromVerticalOffset="10" />
                </TransitionCollection>
            </Grid.Transitions>
            <StackPanel Spacing="12">
                <TextBlock Text="设置" FontSize="28" FontWeight="SemiBold" />
                <TextBlock Text="提示：主题 / Backdrop / 直播后端 会自动持久化。" Opacity="0.8" />

                <Border Style="{StaticResource ChaosCardBorderStyle}" Padding="16">
                    <StackPanel Spacing="12">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="240" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="主题" VerticalAlignment="Center" />
                            <ComboBox x:Name="ThemeCombo" Grid.Column="1" SelectionChanged="OnThemeChanged">
                                <ComboBoxItem Content="跟随系统" Tag="FollowSystem" />
                                <ComboBoxItem Content="深色模式" Tag="Dark" />
                                <ComboBoxItem Content="浅色模式" Tag="Light" />
                            </ComboBox>
                        </Grid>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="240" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="Backdrop（Win11）" VerticalAlignment="Center" />
                            <ComboBox x:Name="BackdropCombo" Grid.Column="1" SelectionChanged="OnBackdropChanged">
                                <ComboBoxItem Content="Mica（更像原生）" Tag="Mica" />
                                <ComboBoxItem Content="Mica Alt（更浅/更分层）" Tag="MicaAlt" />
                                <ComboBoxItem Content="无" Tag="None" />
                            </ComboBox>
                        </Grid>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="240" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="直播后端" VerticalAlignment="Center" />
                            <ComboBox x:Name="LiveBackendCombo" Grid.Column="1" SelectionChanged="OnLiveBackendChanged">
                                <ComboBoxItem Content="自动（优先 FFI）" Tag="Auto" />
                                <ComboBoxItem Content="FFI（chaos_ffi.dll）" Tag="Ffi" />
                                <ComboBoxItem Content="Daemon（chaos-daemon.exe）" Tag="Daemon" />
                            </ComboBox>
                        </Grid>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="240" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="歌词后端" VerticalAlignment="Center" />
                            <ComboBox x:Name="LyricsBackendCombo" Grid.Column="1" SelectionChanged="OnLyricsBackendChanged">
                                <ComboBoxItem Content="自动（优先 FFI）" Tag="Auto" />
                                <ComboBoxItem Content="FFI（chaos_ffi.dll）" Tag="Ffi" />
                                <ComboBoxItem Content="Daemon（chaos-daemon.exe）" Tag="Daemon" />
                            </ComboBox>
                        </Grid>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="240" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="直播：默认全屏播放" VerticalAlignment="Center" />
                            <ToggleSwitch
                                x:Name="LiveDefaultFullscreenToggle"
                                Grid.Column="1"
                                OffContent="关闭"
                                OnContent="开启"
                                Toggled="OnLiveDefaultFullscreenToggled" />
                        </Grid>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="240" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="直播：全屏动画速率(x)" VerticalAlignment="Center" />
                            <muxc:NumberBox
                                x:Name="LiveFullscreenAnimRateBox"
                                Grid.Column="1"
                                Minimum="0.25"
                                Maximum="2.5"
                                SmallChange="0.1"
                                SpinButtonPlacementMode="Compact"
                                ValueChanged="OnLiveFullscreenAnimRateChanged" />
                        </Grid>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="240" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="调试：显示播放提示" VerticalAlignment="Center" />
                            <ToggleSwitch
                                x:Name="DebugPlayerToggle"
                                Grid.Column="1"
                                OffContent="关闭"
                                OnContent="开启"
                                Toggled="OnDebugPlayerToggled" />
                        </Grid>

                        <muxc:InfoBar
                            x:Name="BackdropHint"
                            IsOpen="False"
                            Severity="Informational"
                            Title="提示"
                            Message="Backdrop 仅 Windows 11 生效；Windows 10 将自动降级为“无”。" />
                    </StackPanel>
                </Border>
            </StackPanel>
        </Grid>
    </ScrollViewer>
</Page>
