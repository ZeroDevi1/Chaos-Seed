<UserControl
    x:Class="ChaosSeed.WinUI3.Controls.TtsMiniPlayerControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    xmlns:conv="using:ChaosSeed.WinUI3.Converters"
    Visibility="Collapsed">

    <UserControl.Resources>
        <conv:SecondsToTimeConverter x:Key="SecondsToTimeConverter" />
    </UserControl.Resources>

    <Border
        CornerRadius="14"
        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
        Padding="12">
        <Grid RowSpacing="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <Grid Grid.Row="0" ColumnSpacing="12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- Left: title -->
                <Grid Grid.Column="0" ColumnSpacing="12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="56" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <Border
                        CornerRadius="12"
                        Width="48"
                        Height="48"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        VerticalAlignment="Center">
                        <muxc:SymbolIcon Symbol="Volume" />
                    </Border>

                    <StackPanel Grid.Column="1" Spacing="2" VerticalAlignment="Center">
                        <TextBlock x:Name="TitleText" Text="-" FontWeight="SemiBold" TextTrimming="CharacterEllipsis" />
                        <TextBlock x:Name="SubtitleText" Text="" Opacity="0.75" TextTrimming="CharacterEllipsis" />
                    </StackPanel>
                </Grid>

                <!-- Right: transport -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                    <Button Click="OnPlayPauseClicked" ToolTipService.ToolTip="播放/暂停" CornerRadius="999" MinWidth="44" MinHeight="44">
                        <Button.Background>
                            <SolidColorBrush Color="{ThemeResource SystemAccentColor}" Opacity="0.95" />
                        </Button.Background>
                        <muxc:SymbolIcon x:Name="PlayPauseIcon" Symbol="Play" Foreground="White" />
                    </Button>

                    <Button Click="OnStopClicked" ToolTipService.ToolTip="停止">
                        <muxc:SymbolIcon Symbol="Stop" />
                    </Button>

                    <Button Click="OnSaveClicked" ToolTipService.ToolTip="保存为 wav">
                        <muxc:SymbolIcon Symbol="Save" />
                    </Button>

                    <Button Click="OnCloseClicked" ToolTipService.ToolTip="关闭">
                        <muxc:SymbolIcon Symbol="Clear" />
                    </Button>
                </StackPanel>
            </Grid>

            <Grid Grid.Row="1" ColumnSpacing="10" VerticalAlignment="Center">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="PosText" Text="00:00" Opacity="0.75" VerticalAlignment="Center" />
                <Slider
                    x:Name="PosSlider"
                    Grid.Column="1"
                    Minimum="0"
                    Maximum="1"
                    StepFrequency="1"
                    SmallChange="1"
                    LargeChange="5"
                    IsThumbToolTipEnabled="True"
                    ThumbToolTipValueConverter="{StaticResource SecondsToTimeConverter}"
                    ValueChanged="OnPositionChanged" />
                <TextBlock x:Name="DurText" Grid.Column="2" Text="--:--" Opacity="0.75" VerticalAlignment="Center" />
            </Grid>
        </Grid>
    </Border>
</UserControl>
